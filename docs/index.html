<!doctype html>
<html>
<head>
   <title>Slides</title>
   <meta charset="utf-8">
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
   <style>
      html,body {
         background-color: #242424;
         color: #dddddd;
         font-family: "Segoe UI", Arial, Sans-Serif;
         font-size: 30pt;
         height: 100%;
         text-align: center;
         overflow: hidden;
         padding: 0px;
         margin: 0px;
      }
      #slide {
         max-width: 100%;
         max-height: 100%;
         padding: 0px;
         margin: 0px;
         position: absolute;
         left: 50%;
         top: 50%;
         transform: translate(-50%, -50%);
      }
   </style>
</head>

<body oncontextmenu="clickSlide(-1); return false;" onclick="clickSlide(+1)">
   <img id="slide" src="Slide1.png" onerror="slideError()" /><br/>
</body>

<script>
   const slide_prefix = "Slide";
   const slide_type = ".png";
   var slidenum = 1;
   var slide = $('#slide');

   // Hacky code to set page title to the parent folder name
   var dir = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'))
   document.title = dir.split('/')[dir.split('/').length - 1].replace(/%20/g, ' ')
   // Keyboard and mousewheel  events 
   document.addEventListener("keydown", keyPress);
   document.getElementById('slide').addEventListener("mousewheel", mouseWheel, false);
   document.getElementById('slide').addEventListener("DOMMouseScroll", mouseWheel, false);

   // Advance a slide with dir = +1, go back a slide with dir = -1
   function clickSlide(dir) {
      slidenum += dir;
      if (slidenum < 1) { slidenum = 1; return; }
      slide.fadeTo(300, 0, function() { 
         slide.attr("src", slide_prefix + slidenum + slide_type).fadeTo(700, 1.0); 
      }); 
   }

   // Set current slide
   function setSlide(num) {
      slide.attr('src', slide_prefix + num + slide_type);
   }

   // Error loading slide image, either no slides found or end of the presentation
   function slideError(e) {
      if (slidenum == 1) {
         document.body.innerHTML = "<b>No slides found!</b><br/><br/>Please export all slides from PowerPoint to PNG<br/>e.g. Slide1.png, Slide2.png, etc";
      } else {
         alert("End Of Presentation");
         setSlide(slidenum -= 1);
      }
   }

   // Mouse wheel events to navigate
   function mouseWheel(e) {
      if(e.deltaY > 0) { clickSlide(+1) }
      if(e.deltaY < 0) { clickSlide(-1) }      
   }

   // Keyboard navigation:
   //  Next slide: space, pgdown, down-cursor, right-cursor
   //  Back slide: backspace, pgup, up-cursor, left-cursor
   //  Jump to numbered slide: Number keys 1-9
   //  Blank screen: 'b'
   function keyPress(e){
      var kc = e.which;
      //console.log(kc);
      if (kc == 32 || kc == 34 || kc == 13 || kc == 40 || kc == 39) clickSlide(+1);
      if (kc == 33 || kc == 8 || kc == 37 || kc == 38) clickSlide(-1);
      if (kc >= 49 && kc <= 57) { slidenum = kc - 48; setSlide(slidenum); }
      if (kc == 66) { slide.toggle() }
   }

</script>
